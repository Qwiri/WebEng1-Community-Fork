name: "ðŸ“¦ðŸ”° Deploy slides via GitHub Pages"

on:
  push:
    branches:
    - master
  workflow_dispatch:

jobs:
  build:
    name: "Deploy"
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v2
      
    - name: Add Stylesheets
      uses: jacobtomlinson/gha-find-replace@v2
      with:
        find: |
          <link rel="stylesheet" href="dist/theme/white.css">
        replace: |
          <link rel="stylesheet" id="night" href="dist/theme/night.css">
          <link rel="stylesheet alternate" id="white" href="dist/theme/white.css">
          <link rel="stylesheet alternate" id="moon" href="dist/theme/moon.css">

          <script defer>
              let themes = [ 'night', 'white', 'moon' ];
              let current = 0;

              function toggleTheme() {
                current = (current + 1) % themes.length;
                for (const i in themes) {
                  if (current == i) {
                    console.log("enabling", themes[i])
                    document.getElementById(themes[i]).setAttribute("rel", "stylesheet");
                  } else {
                    console.log("disabling", themes[i])
                    document.getElementById(themes[i]).setAttribute("rel", "stylesheet alternate");
                  }
                }
              }
          </script>
    
    - name: Add Change Theme Button
      uses: jacobtomlinson/gha-find-replace@v2
      with:
        find: |
          <div class="reveal">
        replace: |
          <button onclick="toggleTheme()">Change Theme</button>
          <div class="reveal">

    - name: Deploy
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./added_2021
        cname: webeng1.d2a.io
